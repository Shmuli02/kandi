\chapter{Kirjautumismenetelmät\label{kirjautumismenetelmät}}

Tässä luvussa esitellään kirjautumiseen käytettävät todentamistavat. Tämän jälkeen esitellään yksi-, kaksi- ja monivaiheinen kirjautuminen.
Kirjautumiseen käytetyt menetelmät voidaan jakaa kolmeen eri kategoriaan: jotain mitä tiedät, jotain mitä omistat ja jotain mitä olet.

Ensimmäinen todentamistapojen kategoria perustuu jonkin asian tietämiseen. Esimerkiksi salasana tai PIN-koodi ovat todentamistapojen perusteena olevia asioita. Myös ensimmäisen lemmikin nimi on asia jonka tiedät ja kuuluu tähän kategoriaan. Toiseen kategoriaan kuuluu asioita ja esineitä, joita omistat tai ovat käyttäjän hallussa. Puhelin on esine, joka löytyy nykyään jokaiselta. Puhelin voidaan määritellä esineeksi, jolla on fyysinen omistaja ja siten sitä voidaan käyttää todentamiseen. Toinen esimerkki fyysisestä esineestä on käyntikortti, jolla on fyysinen omista siten sitäkin, voidaan käyttää todentamiseen. Kolmas todentamismenetelmä perustuu henkilön yksilöllisistä ominaisuuksista kuten sormenjälki, kasvot, DNA ja ääni.

\section{Yksivaiheinen kirjautuminen}

Yksivaiheinen kirjautuminen (single-factor authentication, SFA) koostuu yhdestä tarvittavasta todentamistavasta. Yksivaiheisessa kirjautumisessa käytetään yleensä todentamistapana ”jotain mitä tiedät”. Salasana ja PIN-koodi ovat yleisimpiä todentamistapoja \citep{NIST_800_63B}.

Yksivaiheinen kirjautuminen ei yksinään ole turvallinen vaihtoehto. Pelkästään salasanan käyttäminen ei ole turvallista koska siihen liittyy turvallisuusongelmia. Salasanoja on mahdollista arvata tietokoneiden avulla. Tietokoneen tehosta riippuen salasanoja on mahdollista arvata 10 000–1 000 000 000 salasanaa sekunnissa. Riippuen salasanan pituudesta ja merkeistä on salasana mahdollista arvata jopa muutamassa minuutissa \citep{brute_force_attack}. Toinen turvallisuusriski liittyy vuotaneisiin salasanoihin. Vuotaneita käyttäjätunnuksia noin 12 miljardia kappaletta noin 600 verkkosivulta \citep{Have_i_been_pwned}. Hyökkääjät voivat käyttää näitä vuotaneita salasanoja hyväkseen. Pelkästään salasanaan perustuva suojaus ei ole turvallista. Tämän takia kaksivaiheista kirjautumista on alettu käyttämään laajemmin. 

\section{Kaksivaiheinen kirjautuminen}
Kaksivaiheinen kirjautuminen (Two-factor authentication, 2FA) on kahden edellä mainitun yksivaiheisen kirjautumisen yhdistelmä. Kaksivaiheisessa kirjautumisessa yhdistetään kaksi eri kirjautumistapaa paremman tietosuojan takia. 

Useat verkkopalvelut tarjoavat kaksoisvarmennetta käyttäjille käytettäväksi. Osa yrityksistä jopa vaatii kaikkia käyttäjiä käyttämään kaksivaiheista tunnistautumista. Esimerkiksi Google ilmoitti toukokuussa 2021 vaativansa kaikilta käyttäjiltä kaksivaiheista kirjautumista \citep{future_without_passwords}.

Kaksivaiheisia kirjautumistapoja on olemassa erilaisia. Ensimmäinen on SMS-varmentaminen. SMS-varmentaminen perustuu kahteen todentamistapaan: ”Jotain mitä tiedät” sekä ”jotain mitä omistat”. Kirjautumisen ensimmäisessä vaiheessa pyydetään salasanaa. Salasana toimii tässä menetelmässä asiana, jonka tiedät. Tämän jälkeen tapahtuu kirjautumisen toinen vaihe. Palvelu johon käyttäjä on kirjautumassa, luo kirjautumista varten kertakäyttöisen koodin. Tämä kertakäyttöinen koodi lähetetään käyttäjälle tekstiviestinä puhelimeen. Käyttäjän saatuaan kertakäyttöisen koodin puhelimeensa käyttäjä syöttää koodin ja kirjautuminen hyväksytään. Puhelin toimii tässä menetelmässä asiana, jonka käyttäjä omistaa \citep{jover2020security}.

Kaksivaiheinen kirjautuminen pystytään toteuttamaan myös sähköpostin avulla. Todentamistavat ovat samat kuin SMS-varmenteessa eli ”jotain mitä tiedät” sekä ”jotain mitä omistat”. SMS ja sähköposti varmentamisen käyttöönotto on suhteellisen helppoa. Palvelun tarjoaja tarvitsee pelkästään käyttäjän puhelinnumeron tai sähköpostiosoitteen, johon lähettää kertakäyttöinen koodi jokaisen kirjautumisien yhteydessä. Kirjautumisen ensimmäisessä vaiheessa käyttäjää pyydetään syöttämään ”jotain mitä tietää” eli salasanan. Kirjautumisen toinen vaihe toteutetaan sähköpostia käyttäen. Käyttäjän sähköpostiin lähetetään palvelun luoma kertakäyttöinen koodi, jonka käyttäjä syöttää. Toinen mahdollinen tapa on lähettää sähköpostiin linkki, jota kautta kirjautuminen vahvistetaan.

Kolmas mahdollinen kaksivaiheinen kirjautumismenetelmä on aikaan perustuvat kertakäyttöiset koodit. Aikaan perustuvasta kertakäyttöisestä koodista käytetään lyhennettä TOTP, joka tulee menetelmän englanninkielisestä käännöksestä time-based one-time password. Menetelmän ensimmäinen vaihe on samanlainen kuin edellisissä menetelmissä eli ensimmäiseksi pyydetään käyttäjän tietämä salasana. Toinen vaihe perustuu sitten aikaan perustuvaan kertakäyttöiseen koodiin. Aikaan perustuva kertakäyttöinen koodi perustuu nimensä mukaisesti aikaan. Kertakäyttöiset koodit generoituvat salaisen avaimen perusteella ja ne vaihtuvat tietyn määritellyn ajan välein. Määritellyksi ajaksi suositellaan 30 sekuntia \citep{m2011totp} \citep{NIST_800_63B}.

TOTP:n käyttäminen ja käyttöönotto on erilainen kuin SMS ja sähköposti varmentamisessa. TOTP:ssä palvelu ei lähetä mitään koodeja, vaan varmentaminen tapahtuu ajan perusteella vaihtuvilla koodeilla. Aikaan perustuvat kertakäyttöiset koodit luodaan salaisella avaimella. Kun käyttäjä ottaa TOTP:n käyttöön, palvelu luo salaisen avaimen. Käyttäjän täytyy ottaa tämä salainen avain itselleen talteen, koska aikaan perustuvat kertakäyttöiset koodit luodaan tämän salaisen avaimen perusteella. TOTP salaisten avaimien säilyttämiseen ja koodien generoimiseen on kehitetty mobiilisovelluksia. Tähän tarkoitettuja mobiilisovelluksia ovat esimerkiksi Google Authenticator, Microsoft Authenticator ja LastPass Authenticator \citep{best_authenticator_apps}. Palvelut tarjoavat yleensä QR-koodin, joka sisältää salaisen avaimen sekä muita tietoja kuten otsikon, algoritmin, kuinka pitkä kertakäyttöinen koodi on sekä kuinka usein kertakäyttöinen koodi vaihtuu. Mobiilisovelluksella skannataan QR-koodi. Mobiilisovellus tallentaa QR-koodin sisältävät tiedot muistiin. Tämän jälkeen mobiilisovellus luo kertakäyttöisiä koodeja perustuen salaiseen avaimeen sekä muihin tietoihin. Kun käyttäjä kirjautuessaan syöttää kertakäyttöisen koodin, palvelu tarkistaa vastaako käyttäjän antama kertakäyttöinen koodia samaa mitä salaisen avaimen perusteella täytyisi olla.

\section{Monivaiheinen kirjautuminen}

Monivaiheinen tunnistautuminen (Multi-factor authentication, MFA) koostuu kahdesta tai useammasta tunnistautumistavasta \citep{two_factor_multi_factor_difference}.

Monivaiheisia tunnistautumistapoja on olemassa paljon erilaisia. Fyysisen avaimen käyttäminen on yksi menetelmä. Fyysinen avain voi olla esimerkiksi USB-muistitikku, joka sisältä salaisen avaimen. Kirjautumisen yhteydessä järjestelmä tarkistaa, että salaisen avaimen on oikea. Fyysisestä avaimesta on olemassa erilaisia toteutuksia. Fyysisen avaimen lukituksen avaamiseen voidaan vaatia salasanaa tai PIN-koodia. Fyysiseen avaimen avaamiseen voidaan myös käyttää biometristä tunnistautumista kuten sormenjälkeä. Fyysinen avain voi tukea (Near-field communication) NFC-tiedonsiirtoa, jolloin sitä voidaan käyttää todentamiseen myös mobiililaitteella.
Toinen mahdollinen monivaiheinen kirjautumismenetelmä on mobiilisovelluksella kirjautuminen. Kirjautuminen vahvistetaan mobiilisovelluksen avulla. Kun käyttäjä yrittää kirjautua palveluun mobiilisovellukseen tulee tästä ilmoitus. Käyttäjän täytyy käydä hyväksymässä tai hylkäämässä kirjautuminen mobiilisovelluksessa. Tässä menetelmässä käytetään puhelinta varmentamisena eli jotain mitä omistat. Mobiilisovelluksessa tehtävän hyväksynnän tai hylkäämisen yhteydessä voidaan lisäksi pyytää PIN-koodia tai biometristä varmentamista. Näin saadaan vielä yksi todentamismenetelmä lisää. Varsinkin biometrisen vahvistuksen lisääminen on hyvä, sillä silloin kirjautumiseen vaaditaan kolme todentamismenetelmää, jotka kaikki ovat eri kategorioista. 

Monivaiheinen kirjautuminen voidaan myös toteuttaa digitaalisten laitteiden avulla ja niiden sisään rakennettujen ominaisuuksien avulla. Kirjautuminen voidaan esimerkiksi toteuttaa puhelimien käyttöjärjestelmän ja puhelimen fyysisten ominaisuuksien avulla. 

Monivaiheinen kirjautuminen voi koostua monesta todentamisvaiheesta. Ääriesimerkkinä Korean pankki, jolla on käytössä monimutkainen ja monivaiheinen kirjautuminen. Käyttäjän täytyy asentaa tietokoneelleen ohjelma, joka sisältää sertifikaatin kirjautumista varten. Käyttäjä tarvitsee myös fyysisen numerokortin, jossa on kertakäyttöisiä koodeja. Käyttäjä tarvitsee lisäksi kaksi asiaa, jotka hän tietää eli PIN-koodin sekä salasanan. Tämän lisäksi puhelimeen lähetetään kertakäyttöinen koodi. Kirjautuminen koostuu kahdesta asiasta, ”jotka tiedä” (PIN-koodi ja salasana) ja kolmesta asiasta, ”jotka omistat” (sertifikaatti, koodi kortti ja SMS). Monivaiheinen tunnistautuminen voi siis koostua monesta todentamistavasta. Vaikka vahva tunnistautuminen on tärkeää, tulisi pitää jokin järkevä raja kuinka monimutkainen varmentamisprosessi on \citep{rittenhouse2015survey}.
